[TOC]

# 简介

Lua是一种脚本语言,纯C语言写的，方便跨平台
脚本语言类似于替换文本,修改代码的执行逻辑 
Lua的执行方式
  - 使用.exe执行文件执行脚本
  - 通过动态链接库执行脚本
  - 把源码加入项目,项目调用API执行脚本文件


> 早期wow引入了lua，可以使用插件，天龙八部广泛使用lua
>
> 手游热更新大量使用lua
>
> lua有一个分支项目lua-jit，执行比lua快一些

[官方网址](www.lua.org)

##  使用源码
- 直接把源码嵌入到项目中，可以在源码基础上添加lua的功能，比如支持中文
- 可以把加载运行的脚本名字修改了，提高外挂门槛

Lua源码可以产生2种文件，解析执行器 lua.exe和 字节码加密  luac.exe
使用lua.exe ,执行`dofile("文件路径")`,可以执行脚本文件
> 如果在powershell下,需要使用.\执行
使用luac.exe ,无法直接双击执行,只能把脚本文件拖上去生成字节码文件,或者通过系统的cmd命令执行

```shell
\luac.exe -o 输出的文件名 输入的文件
```
产生的字节码文件也能用 lua.exe解读,执行速度更快
学习lua ： 云风知乎

# Lua的编译
Lua因为有两个执行文件luac 和 lua,所以会有两个main函数,两者不能同时编译,每次编译需要暂时移除(不是删除)其中一个才能编译成功.

lua作为外部工具使用每次用cmd执行很麻烦,可以把编译好的exe路径配置到系统

## 静态库的编译
- 创建静态库项目,选择所有源码文件,排除入口文件,直接生成

## Lua动态库编译
- 建静态库项目,选择所有源码文件,排除入口文件
> 此时如果生成,不会有导出函数
> 因为没有导出符号__declspec(dllexport),生成时就不会有导出函数,意味着无法调用

- 需要在luaconf.h里面找到LUA_BUILDE_DLL编译参数宏复制到项目-属性-C/C++ - 预处理器-预处理器定义中



# Lua的编辑工具

## LuaEditor(免费)/LuaStudio(收费)

F5进行调试，

F9打断点，

### 使用软件调试

直接以调试器作为宿主进行调试，即直接用这个软件进行调试执行

### 使用指定exe调试

如果要使用指定的调试版本,去掉勾选

工作目录主要是针对脚本引用了其他文件,需要把工作目录设置好

使用指定调试,无法执行断点操作,需要选择附加到进程



## notepad++使用luascript插件

2种使用方法

- 在下面的窗口直接写
- 在文本框写好后,点击 **插件- luascript- 运行当前文件**

版本不能更换



## VScode

在扩展里面找到Luahelper 

安装后,在**运行-添加配置**找到Luahelper

> - attach调试的目标是一个已经运行的程序
> - debug file 调试目标是一个文件

选择debug file后,需要打开文件所在的文件夹作为参考目录
