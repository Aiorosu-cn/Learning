[TOC]

# 混合动画

UE4中有多种动画的过渡（混合）方式

- 混合空间，常用
- alpha值叠加，一个逐渐消失一个逐渐显示
- 直接覆盖
- 将动画发送到骨架中特定骨骼及其子项。比如边跑边射击



# 蒙太奇使用

## 蒙太奇能做什么

2种创建蒙太奇的方法

- 右键动画创建对应的蒙太奇
- 创建空蒙太奇，并自己导入动画编辑

 你可以将该动画分成三部分（拿起弹夹、开始装弹，返回闲散姿势），并将它们组合在蒙太奇中。你可以将它们分段，然后选择播放其中的个别片段，或者播放所有片段。

蒙太奇的部分其他用途包括：

- 可以在 **动画蓝图（Animation Blueprint）** 的 **事件图（Event Graph）** 中播放动画。
- 可将复杂的动画序列串联起来，让它们成为一个动画。
- 可根据代码或蓝图脚本仅循环一个或多个动画中的特定部分。
- 可根据代码或蓝图脚本处理多个动画的基于事件的切换。
- 可将复杂的动画序列分配到可在代码或蓝图脚本中切换的指定槽中。
- 可根据代码或蓝图脚本在各种动画序列之间精确切换。



## 蒙太奇解析

**蒙太奇** 区域的组成如下：

1. **片段（Sections）** - 显示在蒙太奇中创建的任何片段。
2. **插槽（Slot）** - 显示添加到当前插槽的动画。
3. **组/插槽（Group/Slot）** - 显示当前选定的动画组和插槽。

### 片段

通过创建 **片段（Sections）**，可将一个插槽分解为多个动画部分。每个片段都有一个名称，并且在槽的时间轴中有自己的位置。 你可以使用该名称直接跳转到某个特定片段，或将某个片段安排为接在当前片段结束时播放。 在 **蓝图（Blueprint）** 中，你可以查询当前片段，跳转到某个片段，或设置将要播放的下一个片段。

你可以把片段想象成音乐播放列表中的歌曲，而插槽就是音乐专辑。 你正在播放某个片段（歌曲）时，可以排队或在当前片段结束后跳转到插槽（专辑）中的另一片段，或者直接跳转到想要立即播放的片段。



### 插槽

在蒙太奇中，一个 **插槽（Slot）** 就是一条轨迹，其中可容纳任意数量的动画。你可以任意命名插槽，并使用该名称混合到其中的动画中。 回到装弹蒙太奇的例子，我们可以针对角色站立时或匍匐时创建不同的装弹版本。 在这种情况下，我们将每个版本的角色姿势单独放置到蒙太奇（如下）中的各个插槽，并使用 **动画蓝图（Animation Blueprint）** 的 **动画图（AnimGraph）** 中的 **插槽（Slot）** 节点来决定使用哪个动画集，具体取决于角色是站着还是匍匐。

我们在角色站立装弹时使用 **DefaultProne** 插槽，在角色匍匐装弹时使用 **Prone** 插槽。

如果指定了多个插槽，可单击要在编辑器中预览的插槽的 **预览** 按钮进行预览。

为了在使用多个插槽时获得最佳效果，请确保所涉及的多个动画的时间从头到尾长度相同。





### 组/插槽

**动画组（Anim Groups）** 是一系列的插槽（Slots），每组只能播放一个蒙太奇。如果要同时播放另一个蒙太奇，可以为其创建一个新的组。 动画组和插槽集中在 **Anim Slot Manager** 选项卡中。要打开它，请单击 **AnimSlot Manager**（**放大镜**）图标。使用下拉菜单从可用插槽中进行选择。 在创建新的蒙太奇时，插槽节点在最初有一条 **默认槽（Default Slot）**，这样它们就能立即发挥作用。





## 每个组成部分可进行的操作

### 片段

在 **片段（Sections）** 区域中，你可以为在蒙太奇区域中定义的片段建立相互关系。

1. **创建默认/清除（Create Default/Clear）** - 点击 **创建默认** 在所有片段之间创建默认关联，并点击 **清除** 按钮将所有关联清除时将它们逐一串联起来。
2. **片段按钮（Section Buttons）** - 在此区域中，显示"蒙太奇"（Montage）区域中定义的每个片段对应的按钮。你可以将其分配给片段关联。
3. **片段关联轨迹（Section Association Tracks）** - 在这里，单击 **预览所有片段（Preview All Sections）** 可将动画片段之间的关系可视化，单击每个轨迹的 **预览（Preview）** 查看单个轨迹。

#### 循环播放

可以将片段设置为无限循环播放，这对于任何需要重复的动作极为有用。 在一条片段关联轨迹中多次关联同一片段就可以使该关联轨迹循环运行。 这会将片段变成蓝色。

例如，一个角色正在为散弹枪装弹的动画，每次只能装填一颗子弹。你可以循环播放角色装入子弹的片段。然后使用 **Notifies** 在蓝图中创建 **Notify** 事件，没播放一次动画就增加一次弹药数。一旦数量达到设定值（代表装弹已满），就可以切换到角色关闭弹药并恢复闲散姿态的动画。

### 元素计时

**元素计时（Element Timing）** 轨迹从 **蒙太奇** 和 **通知** 区域提取信息，以帮助设定不同片段的时间。

轨迹中的每个节点都有一个号码，表示该对象在蒙太奇中的触发顺序，并按以下规则显示颜色：

- **红色** - 表示通知、通知状态和通知状态结束标记。
- **浅蓝色** - 表示分支点。
- **绿色** - 表示蒙太奇片段。

单击元素计时轨迹上的下拉按钮，将出现显示/隐藏其他信息的选项。

### 通知区域

[动画通知](https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/SkeletalMeshAnimation/Sequences/Notifies)（简称 **通知(Notifies)**）可以将事件设置为在动画中的特定点发生。 例如，在上图中，我们将通知设置为每次播放装弹动画时，在装弹蒙太奇中播放拿起弹夹的声音。 我们还调用了一个名为 **SpawnClip** 的自定义事件。它可以用来生成代表弹药夹场景的网格体。 最后，在循环部分中使用 **分支** 事件，决定是否退出循环并前进到动画的结束片段。角色在结束片段会返回闲散姿态。

### 曲线

[动画曲线](https://docs.unrealengine.com/4.27/zh-CN/AnimatingObjects/SkeletalMeshAnimation/Sequences/Curves) 可以在动画播放期间更改材质参数或变形目标值的方法。 这样便可指定要更改的资源（材质或变形目标），相应地命名曲线，并在动画持续时间内调整关键帧值。